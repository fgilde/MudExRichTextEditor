export function initializeMentionModule(t,i){return new n(t,i)}class n{constructor(n,t){this.options=t;this.dotnet=n;this.type=t.type;window.addEventListener("mention-hovered",this._onMentionHovered=this.onMentionHovered.bind(this));window.addEventListener("mention-clicked",this._onMentionClicked=this.onMentionClicked.bind(this))}onMentionHovered(n){n?.value?.__editorId===this.editor.id&&n?.value?.__type===this.type&&(n.value.data=n.value?.data||JSON.parse(n.value.__dataJson),this.dotnet.invokeMethodAsync("OnMentionHovered",n.value))}onMentionClicked(n){n?.value?.__editorId===this.editor.id&&n?.value?.__type===this.type&&(n.value.data=n.value?.data||JSON.parse(n.value.__dataJson),this.dotnet.invokeMethodAsync("OnMentionClicked",n.value))}getMentions(){return this.editor.__quill.getContents().ops.filter(n=>n.insert&&n.insert.mention&&n.insert.mention.__type===this.type).map(n=>this.__getMentionItem(n.insert.mention))}__getMentionItem(n){return{denotationChar:n.denotationChar,id:n.id,value:n.value,data:n.data||JSON.parse(n.__dataJson)}}_checkPosition(){const n=this.editor.querySelector(".ql-mention-list-container"),t=this.editor.__quill,i=t.getSelection();if(i&&i.length===0){const r=t.getBounds(i.index),u=t.container.getBoundingClientRect(),f=u.top+r.top,e=u.left+r.left;n.style.position="fixed";n.style.top=f+"px";n.style.left=e+"px"}}__getMentionConfig(n,t,i){this.editor=i;var r=n?.modules?.mention,u={allowedChars:/^[A-Za-z\sÅÄÖåäö]*$/,dataAttributes:["id","value","denotationChar","link","target","disabled","__dataJson","__editorId","__type"],mentionDenotationChars:this.options.denotationChars,onSelect:(n,t)=>{if(n?.__editorId===this.editor.id&&n?.__type===this.type){var i=this.__getMentionItem(n);this.dotnet.invokeMethodAsync("OnBeforeSelect",i);t(n);this.dotnet.invokeMethodAsync("OnAfterSelect",i)}},source:async(n,t,r)=>{this.options?.denotationChars?.includes(r)&&(t((await this.dotnet.invokeMethodAsync("GetSuggestions",r,n)).map(n=>(n.__editorId=i.id,n.__type=this.type,n.__dataJson=JSON.stringify(n.data),n))),this._checkPosition())}};return{mention:{...r,...u,mentionDenotationChars:r?.mentionDenotationChars?[...new Set([...r.mentionDenotationChars,...u.mentionDenotationChars])]:u.mentionDenotationChars,onSelect:(n,t)=>{r?.onSelect?.(n,t);u.onSelect(n,t)},source:async(n,t,i)=>{r?.source&&await r.source(n,t,i),await u.source(n,t,i)}}}}dispose(){window.removeEventListener("mention-hovered",this._onMentionHovered);window.removeEventListener("mention-clicked",this._onMentionClicked)}}window.MentionModule=n;